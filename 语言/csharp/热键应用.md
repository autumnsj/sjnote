1\. using System;\
2. using System.Collections.Generic;\
3. using System.Text;\
4. using System.Runtime.InteropServices;\
5. using System.Windows.Forms;\
6.\
7. namespace WindowsApplication1\
8. {\
9. public class HotKey\
10. {\
11. //如果函数执行成功，返回值不为0。\
12.
//如果函数执行失败，返回值为0。要得到扩展错误信息，调用GetLastError。\
13. \[DllImport(\"user32.dll\", SetLastError = true)\]\
14. public static extern bool RegisterHotKey(\
15. IntPtr hWnd, //要定义热键的窗口的句柄\
16. int id, //定义热键ID（不能与其它ID重复）\
17. KeyModifiers fsModifiers,
//标识热键是否在按Alt、Ctrl、Shift、Windows等键时才\
会生效\
18. Keys vk //定义热键的内容\
19. );\
20.\
21. \[DllImport(\"user32.dll\", SetLastError = true)\]\
22. public static extern bool UnregisterHotKey(\
23. IntPtr hWnd, //要取消热键的窗口的句柄\
24. int id //要取消热键的ID\
25. );\
26.\
27.
//定义了辅助键的名称（将数字转变为字符以便于记忆，也可去除此枚举而直接使用数\
值）\
28. \[Flags()\]\
29. public enum KeyModifiers\
30. {\
31. None = 0,\
32. Alt = 1, Ctrl = 2,

1\. Shift = 4,\
2. WindowsKey = 8\
3. }\
4.\
5. }\
6. }\
调用方法：\
\[c-sharp\] view plaincopy\
1. using System;\
2. using System.Collections.Generic;\
3. using System.ComponentModel;\
4. using System.Data;\
5. using System.Drawing;\
6. using System.Text;\
7. using System.Windows.Forms;\
8.\
9. namespace WindowsApplication1\
10. {\
11. public partial class Form1 : Form\
12. {\
13. public Form1()\
14. {\
15. InitializeComponent();\
16. }\
17.\
18. private void Form1_Load(object sender, EventArgs e)\
19. {\
20.
//注册热键Shift+S，Id号为100。HotKey.KeyModifiers.Shift也可以直接使用数字4来表\
示。\
21. HotKey.RegisterHotKey(Handle, 100, HotKey.KeyModifiers.Shift,
Keys.S);\
22.
//注册热键Ctrl+B，Id号为101。HotKey.KeyModifiers.Ctrl也可以直接使用数字2来表\
示。

23\. HotKey.RegisterHotKey(Handle, 101, HotKey.KeyModifiers.Ctrl,
Keys.B);\
24.
//注册热键Ctrl+Alt+D，Id号为102。HotKey.KeyModifiers.Alt也可以直接使用数字1来\
表示。\
25. HotKey.RegisterHotKey(Handle, 102, HotKey.KeyModifiers.Alt \|
HotKey.KeyModifie\
rs.Ctrl, Keys.D);\
26. //注册热键F5，Id号为103。\
27. HotKey.RegisterHotKey(Handle, 103, HotKey.KeyModifiers.None,
Keys.F5);\
28. }\
29.\
30. protected override void WndProc(ref Message m)\
31. {\
32. const int WM_HOTKEY = 0x0312;\
33. //按快捷键\
34. switch (m.Msg)\
35. {\
36. case WM_HOTKEY:\
37. switch (m.WParam.ToInt32())\
38. {\
39. case 100: //按下的是Shift+S\
40. this.Text = \"按下的是Shift+S\";\
41. break;\
42. case 101: //按下的是Ctrl+B\
43. //此处填写快捷键响应代码\
44. this.Text = \"按下的是Ctrl+B\";\
45. break;\
46. case 102: //按下的是Alt+D\
47. //此处填写快捷键响应代码\
48. this.Text = \"按下的是Ctrl+Alt+D\";\
49. break;\
50. case 103:\
51. this.Text = \"F5\";\
52. break;\
53. }\
54. break;\
55. }\
56. base.WndProc(ref m);

57\. }\
58. }\
59. }
